"use strict";const userInput=document.querySelector(".js_userInput"),buttonSearch=document.querySelector(".js_buttonSearch"),resultsSearch=document.querySelector(".js_resultsSearch"),favoriteList=document.querySelector(".js_favoriteList");let seriesSearch=[],favorites=[];const saveLocalStorage=()=>{localStorage.setItem("data",JSON.stringify(favorites))},renderCards=e=>{let r="",a="";for(const t of e){const e="https://via.placeholder.com/210x295/fc9303/666666/?text="+t.title;a=-1!==favorites.findIndex(e=>e.id===t.id)?"favoriteSlect":"",r+=` <div class="card js-card ${a}" id="${t.id}">`,"https://cdn.myanimelist.net/img/sp/icon/apple-touch-icon-256.png"===t.image?r+=` <img class="card__image" src="${e}"/>`:r+=` <img class="card__image" src="${t.image}"/>`,r+=` <h3 class="card__title">${t.title}</h3>`,r+="</div>"}return r},renderCardsSearch=()=>{resultsSearch.innerHTML=renderCards(seriesSearch),cardListener()},renderFavSeries=()=>{favoriteList.innerHTML=renderCards(favorites),cardListener()},handleClickSearch=e=>{e.preventDefault();const r=userInput.value.toLowerCase();fetch("https://api.jikan.moe/v4/anime?q="+r).then(e=>e.json()).then(e=>{seriesSearch=e.data.map(({mal_id:e,title:r,images:a})=>({id:e,title:r,image:a.jpg.image_url})),renderCardsSearch()}).catch(e=>console.log("Ha sucedido un error: "+e))},handleClickFavorite=e=>{const r=parseInt(e.currentTarget.id),a=seriesSearch.find(e=>e.id===r),t=favorites.findIndex(e=>e.id===r);-1===t?favorites.push(a):favorites.splice(t,1),console.log(favorites),renderFavSeries(),renderCardsSearch(),saveLocalStorage()},handleEnterKey=e=>{e&&"Enter"===e.key&&(e.preventDefault(),handleClickSearch(e))},cardListener=()=>{document.querySelectorAll(".js-card").forEach(e=>{e.addEventListener("click",handleClickFavorite)})};buttonSearch.addEventListener("click",handleClickSearch),userInput.addEventListener("keypress",handleEnterKey);const onLoad=()=>{favorites=JSON.parse(localStorage.getItem("data")),null===favorites&&(favorites=[],saveLocalStorage()),renderFavSeries()};favorites=JSON.parse(localStorage.getItem("data")),null===favorites&&(favorites=[],saveLocalStorage()),renderFavSeries();