"use strict";const isFavSeries=e=>-1!==favourites.findIndex(r=>r.id===e),renderCards=(e,r)=>{let t="";const a=r?"resultCard":"favCard";return e.forEach(e=>{let s="";const i="https://via.placeholder.com/150x200/816f9f/000000/?text="+e.title;var l;r&&(l=e.id,-1!==favourites.findIndex(e=>e.id===l))&&(s="favouriteSelect"),t+=` <li class="card js-card-${a} ${s}" id="card-${e.id}">`,"https://cdn.myanimelist.net/img/sp/icon/apple-touch-icon-256.png"===e.image?t+=` <img class="card__image" src="${i}"/>`:t+=` <img class="card__image" src="${e.image}"/>`,t+=` <h3 class="card__title3">${e.title}</h3>`,r||(t+=` <div class="iconDelete js-iconDelete" id="delete-${e.id}"><i class="  fa-solid fa-circle-xmark" ></i></div>`),t+="</li>"}),t},userInput=document.querySelector(".js_userInput"),buttonSearch=document.querySelector(".js_buttonSearch"),resultsSearch=document.querySelector(".js_resultsSearch"),favouriteList=document.querySelector(".js_favouriteList"),buttonDeleteAllFav=document.querySelector(".js_buttonDeleteFavourites");let seriesSearch=[],favourites=[];const saveLocalStorage=()=>{localStorage.setItem("data",JSON.stringify(favourites))},renderCardResult=()=>{resultsSearch.innerHTML=renderCards(seriesSearch,!0),cardListener()},renderFavSeries=()=>{favouriteList.innerHTML=renderCards(favourites,!1),iconDeleteListener()},handleClickSearch=e=>{e.preventDefault();const r=userInput.value.toLowerCase();fetch("https://api.jikan.moe/v4/anime?q="+r).then(e=>e.json()).then(e=>{seriesSearch=e.data.map(({mal_id:e,title:r,images:t})=>({id:e,title:r,image:t.jpg.image_url})),0===seriesSearch.length?resultsSearch.innerHTML=`No se ha encontrado ningÃºn resultado para ${r}.`:renderCardResult()}).catch(e=>console.log("Ha sucedido un error: "+e))},handleClickFavourite=e=>{const r=e.currentTarget.id.split("-"),t=parseInt(r[1]),a=seriesSearch.find(e=>e.id===t),s=favourites.findIndex(e=>e.id===t);-1===s?favourites.push(a):favourites.splice(s,1),renderFavSeries(),renderCardResult(),saveLocalStorage()},handleEnterKey=e=>{e&&"Enter"===e.key&&(e.preventDefault(),handleClickSearch(e))},handleDeleteAllFavourites=e=>{e.preventDefault(),favourites=[],renderFavSeries(),saveLocalStorage()},cardListener=()=>{document.querySelectorAll(".js-card-resultCard").forEach(e=>{e.addEventListener("click",handleClickFavourite)})},iconDeleteListener=()=>{document.querySelectorAll(".js-iconDelete").forEach(e=>{e.addEventListener("click",handleClickFavourite)})};buttonSearch.addEventListener("click",handleClickSearch),userInput.addEventListener("keypress",handleEnterKey),buttonDeleteAllFav.addEventListener("click",handleDeleteAllFavourites);const onLoad=()=>{favourites=JSON.parse(localStorage.getItem("data")),null===favourites&&(favourites=[],saveLocalStorage()),renderFavSeries()};favourites=JSON.parse(localStorage.getItem("data")),null===favourites&&(favourites=[],saveLocalStorage()),renderFavSeries();